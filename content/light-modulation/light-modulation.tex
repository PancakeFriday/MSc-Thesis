\chapter{Chopping}
\todo{Better headline}

%The concepts of our ultracold atom experiment were highlighted in \mbox{Chapter \ref{ch:motivation}}, most importantly,
%Coherent light produced by lasers is the key ingredient in ultracold atom experiments in order to work with the atoms on a quantum level. This allows, amongst other things, to drive interactions between the atoms or select specific spin states out of the system. It is important to have control over the full parameter space of the electromagnetic waves interacting with the atoms, which is where light modulators serve as a powerful tool. Light passing through such an optical component will have its frequency, amplitude or phase changed, based on inputs that can be placed onto the modulators.

%Two important components are highlighted in the following, these are \acp{eom} and \acp{aod}. Some preliminary theory is discussed, which is followed by experimental evaluations and implementations.

Optical tweezers are a fundamental tool in the experiment allowing to have full control over the distribution of potassium atoms. To maintain control over long times, heating of atoms needs to be compensated. For potassium atoms which are cooled on the D1 line, the excited state is strongly anti-trapped, making it impossible to trap atoms that haven't decayed back to the ground state, while simultaneously cooling them. For this reason, cooling and trapping beams alternate out of phase, which can be done on a frequency scale up to the lifetime of the $^2$P$_{1/2}$ state. For reference, the cooling scheme for \ce{^{39}K} is discussed in \cite{Duda2017}.

So far, alternating between the two laser beams, called chopping, was achieved using an \ac{aom}, a device, that can deflect a laser beam based on an input sound wave and thus acting as a fast flip-mirror. This effect is limited by the speed of sound in the medium and results in a chopping frequency of $\SI{1.4}{\mega\hertz}$, governed by the \ac{aom} with the slowest rise time, which can be seen in Figure~\ref{fig:aom_chopping}. By increasing the chopping frequency, the atoms will heat less during each trapping cycle, therefore new ways of alternating the beams are sought out. In the following is discussed an \ac{eom}, which is not limited by sound waves. The modulator is governed by the electro-optical effect, which makes it possible to change the refractive index based on an applied electric field, therefore only limiting it by the electronics that generate the field.

\begin{figure}[t]
	\label{fig:aom_chopping}
\centering{
	\includegraphics{figures/chopping_155.pdf}
	\caption{Chopping in the experiment. Laser beams alternate between each other, with blue being the MOT cooler, orange the MOT repumper and green the SLM tweezer. The amplitude of the MOT beams is limited due to the risetime of the \acp{aom}.}
}
\end{figure}
\todo{acronyms? MOT, SLM}

The devices tested in this thesis are both capable of switching on nanosecond scales, improving the current chopping rate by three orders of magnitude. The theory behind the linear electro-optical effect is discussed after a short recourse on polarization of electromagnetic waves. Lastly, experimental evaluations for two \acp{eom} are presented and discussed.


\section{Theory on Polarization}

\label{sec:pol}

Amongst frequency and amplitude, there is another parameter that can generally be affected in monochromatic electromagnetic waves, which is the polarization. It is the orientation of the wave in space, transverse to the direction of movement. \todo{Reviewers: I only discuss transverse polarization, should I keep it this way or do I make a comment about longitudinal polarization?} In general, a wave travelling along the z-axis can be oriented somewhere in the x-y plane. Therefore, writing the electric field component of the light in this basis takes the following form:

\begin{equation}
	\mathbf{E}(\mathbf{x}, t) = E_x cos\left(kx - wt + \phi_x\right) \mathbf{e_x} + E_y cos\left(ky - wt + \phi_y\right) \mathbf{e_y} .
\end{equation}

Here, $k$ and $w$ refer to the wave number and frequency respectively.
Depending on the amplitudes $E_x$ and $E_y$ and the phases $\phi_x$ and $\phi_y$, the wave can be in different polarization states. If it is not possible to write the wave in this basis, the light is unpolarized. Otherwise, it is \textbf{linear}, when either one of the amplitudes $E_x$ or $E_y$ is zero or when the phase difference $\Delta \phi = \phi_x - \phi_y$ evaluates to 0 or $\pi$. It is \textbf{circular}, when the phase difference $\Delta \phi = \pm \pi/2$ and the amplitudes are the same, $E_x = E_y$. In any other case, the wave is \textbf{elliptically} polarized.

From this point, we can see how to create a device that modifies the polarization. We can do this by retarding one axis stronger than another. Given a material with two refractive indices $n_x$ and $n_y$ along the axes $x$ and $y$, we then get the phase shifts:

\begin{align}
	\phi_x(z) = k_0 n_x z \\
	\phi_y(z) = k_0 n_y z
\end{align}
\label{eq:pol,phases}

where $k_0$ is the free space wave vector of the light. Then a device that retards the phase difference $\Delta \phi$ by $\pi/2$, which is a quarter of the wavelength, can change linearly polarized light to circularly polarized light (or vice-versa) and is therefore called a $\lambda / 4$ waveplate. Similarily, if the phase difference is changed by $\Delta \phi = \pi$, or a half wavelength, then we can turn linear polarization around a given axis or change the orientation of circularly polarized light. This is then called a $\lambda / 2$ waveplate.

\section{Electro-optical modulators}
\label{sec:eom}

Light travelling through a material generally has a speed smaller than the speed of light. This property of the material is the refractive index and is the ratio of the speed of light in the material to the speed of light in vacuum. Materials can change their refractive index by being exposed to an electric field, which in \acp{eom} is generally a crystal connected to two electrodes. There are two prominent electro-optical effects that need to be distinguished. If the refractive index changes linearly with the electric field, the effect is called Pockels effect and the \ac{eom} is called a pockels cell. However if it changes with the square of the electric field, the effect is called Kerr effect. For this thesis, two Pockels cells were studied and therefore we will only discuss the pockels effect.
\todo{Reviewers: Philip proposed to mention the dispersion relation, but I'm not sure if it's relevant and how to work it in}


\subsection{Pockels effect}
\label{sec:pockels_effect}

Following the argumentation from the book Fundamentals of Photonics \cite{Saleh1991}, the pockels effect can be found by evaluating the refractive index with respect to the electric field applied to the modulator. Writing this as $n(E)$ and applying a taylor expansion, we get the following expression:

\begin{equation}
	n(E) = n_0 + \frac{dn}{dE} E + \mathcal{O}(E^2)
\end{equation}

\todo{To the reviewers: the book does the derivation using the electric impermeability, but maybe it makes sense to drop the pockels coefficient, because it's not needed in my case and write everything using dn/dE and then I don't need to write about the impermeability at all?}

The pockels effect is the linear dependence of the refractive index to the electric field, therefore higher orders are neglected. The prefactor can also be found by the change of electric impermeability $\Delta \eta$, which is the ability of a material to be penetrated by an electromagnetic field. From

\begin{align}
	\eta & = \frac{1}{n_0^2},
\end{align}
we get
\begin{align}
	\Delta \eta = \frac{d \eta}{dn_0} \Delta n & = -\frac{2}{n_0^3} \frac{dn}{dE} E = \mathfrak{r} E .
\end{align}
\label{eq:pockel,refr}

This results in the quantity $\mathfrak{r} = -\frac{2}{n_0^3} \frac{dn}{dE}$, which is called the Pockels coefficient given in units of $\SI{}{\meter\per\volt}$. It can be measured by evaluating the refractive index of the material:

\begin{equation}
	n(E) = n_0 - \frac{1}{2} \mathfrak{r} n_0^3 E .
\end{equation}

The pockels cells in this application act as dynamic wave retarders, therefore with the results from section \ref{sec:pol}, we can tune the phase difference $\Delta \phi = \phi_x - \phi_y$ along the axes $x$ and $y$ by applying an electric field.

%The phase shift due to the pockels effect is then calculated via \ref{eq:pol,phases} and \ref{eq:pockel,refr}:
We can see the effect on the phase difference by combining \ref{eq:pol,phases} and \ref{eq:pockel,refr}:

\begin{align}
	\phi & = k_0 L n \\
		 & = k_0 L n_0 - \frac{k_0}{2} L \mathfrak{r} n_0^3 E \\
		 & = \phi_0 - \frac{k_0}{2} L \mathfrak{r} n_0^3 E \\
		 & = \phi_0 - \frac{\pi}{\lambda_0} L \mathfrak{r} n_0^3 E
\end{align}

where the relation $k_0 = 2 \pi / \lambda_0$ of the wave number was used.

It is now instructive to calculate the phase difference, which gives information about the change in polarization. The relations for the refractive indices in the two axis basis are labeled as:

\begin{align}
	n_x(E) = n_{0,x} - \frac{1}{2} \mathfrak{r}_x n_{0,x}^3 E \\
	n_y(E) = n_{0,y} - \frac{1}{2} \mathfrak{r}_y n_{0,y}^3 E
\end{align}

and then the phase difference becomes:

\begin{align}
	\Delta \phi & = \phi_{0,x} - \phi_{0,y} - \frac{\pi}{\lambda_0} E L \left(\mathfrak{r}_x n_x^3 - \mathfrak{r}_y n_y^3\right) \\
	\Delta \phi & = \Delta \phi_{0} - \frac{\pi}{\lambda_0} E L \left(\mathfrak{r}_x n_x^3 - \mathfrak{r}_y n_y^3\right) .
\end{align}

\begin{figure}[t]
\centering{
	\import{figures}{eom_schematic.pdf_tex}
	\caption{Schematic view of light passing through an \ac{eom} of length $L$. The electrodes are positioned on the front and back side of the modulator, the same faces the light enters and exits. The light exiting the \ac{eom} has a relative phase shift $\Delta \Phi$ depending on the change of refractive index due to the applied voltage $V$.}
\label{fig:eom_schem}
}
\end{figure}

The electric field is generated by applying a voltage $V$ to two electrodes that are separated by a distance $d$ and therefore $E = V/d$. We can then define a half-wave voltage $V_\pi$:

\begin{align}
	V_\pi = \frac{d}{L} \frac{\lambda_0}{\mathfrak{r}_x n_x^3 - \mathfrak{r}_y n_y^3}.
\end{align}

Thus, the phase difference can be rewritten as:

\begin{align}
	\label{eq:eom_phase_diff}
	\Delta \phi = \Delta \phi_0 - \pi \frac{V}{V_\pi} .
\end{align}

With this it is clear, that applying the voltage $V_\pi$, the pockels cell will act as a lambda-half waveplate. A visual represantation of the modulator and the light passing through it is given in Figure \ref{fig:eom_schem}.

\subsection{Driving a pockels cell}

Rise and fall times of pockels cells can go as low as nanoseconds. To make use of this speed, one has to deploy clever ways to drive the voltages, especially when these potentials are in the kilovolt-regime. For the two Pockels cells discussed in this thesis, specialized drivers by BME-Bergmann were used.

Schematically, the driver is divided into four inputs that are controlled from the user: ON A, ON B, OFF A and OFF B. These inputs control switches on either side of the pockels cell, so A controls one electrode and B the other. Most importantly, the ON X and OFF X (X referring to either A or B) switches work exclusively, so sending a high to ON X will also send a low to OFF X and vice-versa. It is then possible to apply either a positive high voltage or a negative high voltage, depending on the state of the switches. For full identification of the circuit, which is given in Figure \ref{fig:eom_driver_switches}, the side containing the positive voltage information is called high side and similarily the side containing the negative voltage information is called low side.

A requirement for our experiment is to have the \acp{eom} work consistently. This means it is preferrable to only apply one type of voltage, because it can not be guaranteed that applying the same voltage with different polarity results in the same shift polarization. Most notably, the linearly polarized light has to be perfectly aligned on the axis of the EOM to rotate it $\SI{90}{\degree}$ in either direction. This is in general unrealistic, not only due to human error, but also because the polarization may drift with time.

This means, only positive voltages will be applied, which results in the timing diagrams in Figure \ref{fig:eom_timings}.

\begin{figure}[t]
\centering{
	\begin{multicols}{2}
	\import{figures}{bpp_switches.pdf_tex}
	\import{figures}{dpp_switches.pdf_tex}
	\end{multicols}
	\caption{Schematic of the high voltage switches used inside the bpp-type (left) and dpp-type (right) pockels cell driver from BME Bergmann. Not-Gates on both A and B sides ensure that there is always a potential over the pockels cell. The blue and red paths indicate the connection to apply a positive and negative voltage over the pockels cell respectively.}
\label{fig:eom_driver_switches}
}
\end{figure}

\begin{figure}[t]
\centering{
	\import{figures}{bpp_timings.pdf_tex}
	\caption{Timing diagrams for the pockels cell drivers to turn the polarization of the \ac{eom} $\SI{90}{\degree}$. To get a positive high voltage from the bpp-type driver, the A and B side ON/OFF switches are flipped simultaneously. The dpp-type driver is more flexible, since it also allows negative voltages. The timings displayed here are an example to only apply positive voltages across the pockels cell.}
\label{fig:eom_timings}
}
\end{figure}

\subsection{Evaluation of Leysop Pockels cells}

The following pockels cells from Leysop Ltd. were chosen with the application in mind of switching light on the nanoseond scale on and off. Pockels cells can fulfill this requirement by exploiting the fact that linearly polarized light can be filtered out. This is best achieved by placing a \ac{pbs} directly after the modulator as seen in Figure \ref{fig:eom_setup}. This way, the setup can be configured such that applying no voltage means light passes through the beam splitter, while applying $V_\pi$ means the light gets reflected $\SI{90}{\degree}$ off the beam splitter.
Two  pockels cells were characterized by placing a photodiode on one end of the beam splitter. The \acp{eom} are labeled by the material of their nonlinear crystal, \ac{rtp} and \ac{bbo}. Their characteristics are summarized in table \ref{tbl:eom_crystals}.

\begin{figure}[t]
	\label{fig:eom_setup}
\centering{
	\import{figures}{eom_setup.pdf_tex}
	\caption{The efficiency of the \acp{eom} were evaluated by setting the polarization of the incoming light either horizontal or vertical using the waveplate. The pockels cell will then periodically turn the polarization $\SI{90}{\degree}$, which can be seen by measuring the voltage on the photodiode.}
\label{fig:eom_timings}
}
\end{figure}

\begin{table}
\label{tbl:eom_crystals}
\centering
\begin{tabular}{l|l|l}
	\hline \hline
                                                                                     & RTP                                       & BBO \\ \thickhline
Aperture (crystal dimensions)                                                        & $\SI{3}{\milli\meter}$                    & $\SI{3}{\milli\meter}$   \\ \hline
Total crystal length (2 crystals)                                                    & $\SI{30}{\milli\meter}$                   & $\SI{50}{\milli\meter}$    \\ \hline
\begin{tabular}[c]{@{}l@{}}Approximate half wave voltage\\  (1064nm)\end{tabular}    & $\SI{1.0}{\kilo \volt}$                   & $\SI{2.8}{\kilo\volt}$    \\ \hline
%Typical dynamic extinction ratio (1064nm)                                           & $> 200:1$                                 &     \\ \hline
\begin{tabular}[c]{@{}l@{}}Peak damage threshold (1064nm, 1ns \\ pulse)\end{tabular} & $> \SI{1}{\giga \watt \per \cm \squared}$ & $> \SI{1}{\giga \watt \per \cm \squared}$   \\ \hline
Insertion loss                                                                       & $< \SI{2}{\percent}$                      & $< \SI{1.5}{\percent} $ \\ \hline \hline
\end{tabular}
\caption{Characteristics of the two pockels cells with their respective non-linear crystal materials being RTP and BBO. The aperture, damage threshold and insertion loss are given for future reference.}
\end{table}

Example traces for the \ac{rtp} and \ac{bbo} are given in Figure \ref{fig:eom_example_traces}. The peak at the start of the switch is an artifact of the photodiode. Moreover, the rise and fall times could not be resolved due to the limitations of the photodiode, a home-built model with a bandwidth of roughly $\SI{22}{\mega \hertz}$. However, Bergmann BME lists rise and fall times of various pockels cells \cite{Bergmann2020}, including the ones tested here.

\begin{figure}[t]
\label{fig:eom_example_traces}
\centering{
	\setlength{\figureheight}{2in}
	\setlength{\figurewidth}{\textwidth/2-2.5em}
	%\input{figures/eom_example_traces.tikz}
	\includegraphics{figures/eom_example_traces_155.pdf}
}
\caption{Example traces of light passing through an \ac{eom} and filtered using a polarizing beam splitter. The materials used are \ac{rtp} (left) and \ac{bbo} (right). The absolute value of the amplitude depends on the input power of the laser and was different for both measurements.}
\end{figure}

Stress on the crystal causes the amplitude of the laser on the output of the \ac{eom} to be inconsistent when driving the pockels cell for long times (\~{}$\SI{1}{\second}$) and high repetition rates (\~{}\SI{}{MHz}). This effect can be reduced by alternating the voltage applied to the crystal, which results in Figure \ref{fig:eom_amp_time}, however the effect can only be seen on the \ac{rtp} crystal and not on the \ac{bbo}. With this information, it is clear that the \ac{rtp} crystal should be driven with frequencies up to $\SI{1.2}{\mega \hertz}$ or in the range $1.5$ to $\SI{1.7}{\mega \hertz}$. The amplitude was extracted from the traces by fitting a fourier series.

\begin{figure}[t]
\label{fig:eom_amp_time}
\centering{
	\setlength{\figureheight}{2in}
	\setlength{\figurewidth}{\textwidth-1.2em}
	%\input{figures/eom_amp_time.tikz}
	\includegraphics{figures/eom_amp_time_155.pdf}
}
\caption{Shown is the amplitude of a laser whose polarization was rotated by a pockels cell and then filtered using a polarizing beam splitter. The frequency is the repetition rate of the voltage placed into the \ac{eom}. The two materials are \ac{rtp} (orange) \ac{bbo} (blue). The curves are normalized to their maximum value.}
	%The amplitude of the pockels cell depends on the repitition rate of the signal. The signal in this case was applying $0$, $V_\pi$, $0$ and $-V_\pi$ repeatedly.}
\end{figure}

In order to measure the extinction ratio, the repetition rate is set to $\SI{100}{\kilo \hertz}$, where the amplitude is consistent. Measuring first the dark current of the photodiode and then taking the signal on the output of the beam splitter results in the extinction ratio found in Figure \ref{fig:eom_extc}.

\todo{think about the goodness of the fit}
\begin{figure}[t]
\label{fig:eom_extc}
\centering{
	\setlength{\figureheight}{2in}
	\setlength{\figurewidth}{\textwidth/2-2.5em}
	%\input{figures/eom_extinction.tikz}
	\includegraphics{figures/eom_extinction_155.pdf}
}
\caption{Measurements of extinction ratio for \ac{rtp} (left) and \ac{bbo} (right). The dashed lines indicate the fourier series fit in order to find the high and low level of the signal. The results are $>108:1$ for \ac{rtp} and $>129:1$ for \ac{bbo}.}
\end{figure}
